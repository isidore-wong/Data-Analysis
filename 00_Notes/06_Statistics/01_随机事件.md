### 随机事件
---

#### 1、基本概念

**随机现象**
在现实生活中，一个动作或一件事情，在一定条件下，所得到的结果不能预先完全确定，而只能确定是多种可能结果中的一种，这种现象便是随机现象。

eg. 
- 抛硬币：结果可能为正面、反面
- 掷骰子：结果可能是1,2,3,4,5,6

**随机试验：** 使随机现象得以实现和对它观察的全过程称为随机试验，记为 $E$。

随机试验需满足以下三个条件：
~~~~
1. 可以在相同条件下重复进行；
2. 结果有多种可能性，并且所有可能给结果事先已知；
3. 做一次试验究竟哪个结果出现，事先不能确定。
~~~~

随机试验中出现的**常用术语**：
- 样本空间 $\Omega$：随机试验的所有可能结果组成的集合
- 样本点 $\omega$：随机试验的每一个可能结果
- 随机事件 $A,B,C...$：样本空间中满足一定条件的子集，随机事件在随机试验中可能发生也可能不发生
- 必然事件：在试验中，称一个事件发生是指构成该事件的一个样本点出现。由于样本空间包含了所有的样本点，所以在每次试验中，它总是发生，因此称其为必然事件
- 不可能事件：空集$\phi$不包含任何样本点，且在每次试验中总不发生，因此称为不可能事件

eg.   掷骰子游戏中，我们知道出现的结果可能是1,2,3,4,5,6其中的任意一个数字。那么出现任何一个数字，都可以成为一个样本点；随机事件是什么呢，就是一些样本点的的集合，当然了，是在一定条件下。比如，出现的数字是偶数的结果。那么2,4,6就够成了一个随机事件$A={2,4,6}$。样本空间就是1到6的六个数字$\Omega={1,2,3,4,5,6}$。可以看到$A$ 是$\Omega$的一个子集。空集可以定义$\phi$为结果的数字大于6，显然是不可能出现的。

---

#### 2、概率
##### 2.1 定义
随机试验$E$的样本空间为$\Omega$，对于每个事件$A$，定义一个实数$P(A)$与之对应，若函数$P(.)$满足条件：
1. 对每个事件$A$，均有$0<P(A)<=1$;
2. $P(\Omega)=1$;
3. 若事件$A_1,A_2,A_3,...$ 两两互斥，即对于 $i，j=1,2,...，i \neq j, A_i \cap A_j = \phi$，均有
$P(A_1 \cup A_2 \cup ...) = P(A_1) +P(A_2) +...$

则称$P(A)$为事件$A$的概率。

##### 2.2 主要性质
1. 对于任一事件$A$，均有$P(\overline{A})=1-P(A)$.
2. 对于两个事件$A$和$B$，若$A \subset B$，则有
$P(B-A) = P(B) - P(A), P(B) >P(A)$
3. 对于任意两个事件$A$和$B$，有
$P(A \cup B) = P(A) + P(B) - P(A\cap B)$
4. 计数法则
    - 组合：从N项中选取n项，不考虑选取顺序，其[组合数]为：
    ```math
    C_N^n = \frac{N!} {n!(N-n)!}
    ```

    - 排列：从N项中选取n项，考虑选取顺序，其[排列数]为：
    ```math
    P_N^n = \frac{N!} {(N-n)!}
    ```


eg.  掷骰子中，1,2,3,4,5,6出现的概率均为1/6。 我们令 $A = { 1,2 },B = {1,2,3}$。那么有$\overline{A}={ 3,4,5,6}$。可以看到，出现1或2的概率为1/3，即$P(A) =1/3$；出现1或2或3的概率为1/2，即$P(B) =1/2$。根据性质我们有

1. $P(\overline{A})=1-P(A) =1-1/3=2/3$,也就是出现3或4或5或6的概率；
2. $P(B-A)=1-P(B) -P(A) =1/2-1/3=1/6$,也就是出现3的概率；
3. $P(A \cup B) = P(A) + P(B) - P(A\cap B) = 1/3 +1/2 -1/3 = 1/2$,也就是出现的1或2或3，也就是事件$B$的概率；因为$A \subset B$。这里的$A \cap B = A ={ 1,2 }$。


##### 2.3 古典概率
我们将掷骰子游戏进行推广，设随机事件$E$的样本空间中只有有限个样本点，即 $\Omega= { \omega_1, \omega_2,..., \omega_n }$，其中， $n$为样本点的总数，每个样本点$\omega_i (i =1,2,...,n)$出现是等可能的，并且每次试验有且仅有一个样本点发生，则称这类现象为古典概率。若事件$A$包含个$m$个样本点，则事件 $A$的概率定义为：

```math
P(A) = \frac{m} {n} = \frac{事件A包含的基本事件数} {基本事件总数}
```

基于古典概率的推广中，会涉及到排列组合

    Q：假设有k个不同颜色的球，每个球以同样的概率 1/l 落到l 个格子(l>=k)的每个格中，且每个格子可容纳任意多个球。问，分别求出如下两个事件A和B的概率。
    A: 指定的k个格子中各有一个球；
    B: 存在k个格子，其中各有一个球。

我们思考一下，由于每个球可以平均地落入 $l$ 个格子中的任一个，并且每一个格子中可落入任意多个球，所以 $k$ 个球落入 $l$ 个格子中的分布情况相当于从 $l$ 个格子中选取 $k$ 个的可重复排列，故样本空间共有 $l^k$ 种等可能的基本结果。

所以，事件 $A$ 所含基本结果数应是 $k$ 个球在指定的 $l$ 个格子中的全排列数，即 $k!$，那么有
```math
P(A) = \frac{k!} {l^k} 
```

为了算出事件 $B$ 所含的基本事件数，我们可以分两步进行：因为 $l$ 个格子可以是任意选取的，故可先从 $l$ 个格子中任意选出 $k$ 个出来，那么选法共有 $C^k_l$ 种。对于每种选定的 $k$ 个格子，依上述各有一个球的推理，则有 $k!$个基本结果，故B含有 $C^k_l*k！$ 个基本结果。那么有
```math
P(B) = \frac {C^k_lk！} {l^k} = \frac {l！} {l^k（l-k）!}
```

我们把上述例子应有到具体的问题中，概率论的历史上有一个颇为著名的问题生日问题：求 $k$ 个同班同学没有两人生日相同的概率。

如果把这 $k$ 个同学看作上例中的 $k$ 个球，而把一年365天看作格子，即 $l=365$ ，则上述的 $P(B)$就是所要求的概率。我们令 $k=40$ 时，利用上面的公式，则 $P(B) = 0.109$。换句话说，40个同学中至少两个人同一天过生日的概率是：$P(\overline {B}) = 1 - 0.109 =0.891$。其概率大的出乎意料。

使用Python实现$P(B)$
```
# 我们采用函数的递归的方法计算阶乘：
def factorial(n):
    if n == 0:
        return 1;
    else:
        return (n * factorial(n-1)) 
    
l_fac = factorial(365);          # l的阶乘
l_k_fac = factorial(365-40)      # l-k的阶乘
l_k_exp = 365**40                # l的k次方

P_B =  l_fac /(l_k_fac * l_k_exp)     #P(B）
print("事件B的概率为：",P_B)
print("40个同学中至少两个人同一天过生日的概率是：",1 - P_B)
```

##### 2.4 条件概率
研究随机事件之间的关系时，在已知某些事件发生的条件下考虑另一些事件发生的概率规律有无变化及如何变化，是十分重要的。

1. **定义**

设 $A$ 和 $B$ 是两个事件，且$P(B)>0$，称 $P(A|B)$ 为在事件 $B$ 发生的条件下，事件 $A$ 发生的概率。其中$P(A|B)$为：
```math
P(A|B) = \frac {P(AB)} {P(B)}
```

- eg.

某集体中有 $N$ 个男人和 $M$ 个女人，其中患色盲者男性 $n$ 人，女性 $m$ 人。我们用 $\Omega$ 表示该集体， $A$ 表示其中全体女性的集合，$B$ 表示其中全体色盲者的集合。如果从 $\Omega$ 中随意抽取一人，则这个人分别是女性、色盲者和同时既为女性又是色盲者的概率分别为：

$$P(A) = \frac {M} {M+N} , 

P(B) = \frac {m+n} {M+N} , 

P(AB) = \frac {m} {M+N} $$

```math
P(A) = \frac {M} {M+N} , 

P(B) = \frac {m+n} {M+N} , 

P(AB) = \frac {m} {M+N}
```


如果限定只从女性中随机抽取一人 **(即事件 $A$ 已发生)，那么这个女人为色盲者的(条件)** 概率为 

$$P(B|A) = \frac {m} {M} = \frac {P(AB)} {P(A)}$$

```math
P(B|A) = \frac {m} {M} = \frac {P(AB)} {P(A)}
```



##### 2.5 全概率公式和贝叶斯公式

**准备知识：**
首先我们看一下概率乘法公式和样本空间划分的定义；

- 由条件概率公式，可以得到概率的乘法公式：
  
    $P(AB)=P(B|A)P(A) =P(A|B)P(B)$

- 如果事件组，满足

    1. $B_1,B_2,...$ 两两互斥，即$B_i\cap B_j = \phi，i \neq j ,i,j = 1,2,...$，且$P(B_i)>0,i=1,2,...$
    2. $B_1 \cup B_2 \cup ... = \Omega$

    则称事件组$B_1,B_2,...$是样本空间 $\Omega$ 的一个划分。
    
**全概率公式**

设$B_1,B_2,...$是样本空间 $ \Omega$ 的一个划分，$A$ 为任一事件，则

$P(A) = \sum_{i=1}^{\infty } {P(B_i)P(A|B_i)}$

```math
P(A) = \sum_{i=1}^{\infty } {P(B_i)P(A|B_i)}
```


称为全概率公式。

根据全概率公式和概率乘法公式，我们可以得到**贝叶斯公式**


**贝叶斯公式**

设$B_1,B_2,...$是样本空间 $ \Omega$ 的一个划分，则对任一事件 $A(P(A)>0)$ ,有

$P(B_i|A) =\frac {P(B_i A)} {P(A)} 
          = \frac {P(A|B_i )P(B_i)} {\sum_{j=1}^{\infty }P( B_j)P(A|B_j)} ,i=1,2,... $

```math
P(B_i|A) =\frac {P(B_i A)} {P(A)} 
          = \frac {P(A|B_i )P(B_i)} {\sum_{j=1}^{\infty }P( B_j)P(A|B_j)} ,\ \ i=1,2,... 
```

称上式为贝叶斯公式，称$P(B_i)(i=1,2,...)$ 为先验概率，$P(B_i|A)（i=1,2,...）$为后验概率。

在实际中，常取对样本空间 $\Omega$ 的有限划分 $B_1,B_2,...,B_n$ 。 $B_i$ 视为导致试验结果 $A$ 发生的“原因”，而$P(B_i)$ 表示各种“原因”发生的可能性大小，故称为先验概率；$P(B_i|A)$ 则反应当试验产生了结果 $A$ 之后，再对各种“原因”概率的新认识，故称为后验概率 。

假定用血清甲胎蛋白法诊断肝癌。用 $C$ 表示被检验者有肝癌这一事件，用 $A$ 表示被检验者为阳性反应这一事件。当前有肝癌的患者被检测呈阳性反应的概率为0.95。即 $P(A|C) = 0.95 $ 。当前非肝癌的患者被检测呈阴性反应的概率为0.9。即 $P(\overline {A}|\overline {C}) = 0.90 $ 。若某人群中肝癌患者概率为0.0004，即$P(C) = 0.0004 $，现在有一人呈阳性反应，求此人确为肝癌患者的概率是多少？

解：

$P(C|A) = \frac {P(C)P(A|C)} {P(C)P(A|C)+P(\overline {C} )P(A|\overline {C})} =\frac {0.00040.95}{0.00040.95 + 0.9996*0.1} =0.0038$

```math
P(C|A) = \frac {P(C)P(A|C)} {P(C)P(A|C)+P(\overline {C} )P(A|\overline {C})} 

=\frac {0.00040.95}{0.00040.95 + 0.9996*0.1} =0.0038
```

**贝叶斯公式也是在机器学习中朴素贝叶斯的核心**
















